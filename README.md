# Air pollution data DAG
This is a project is a dag for retriving, transforming and loading air pollution data from [OpenWeather APIs](https://openweathermap.org/) and [Weather API](https://www.weatherapi.com/) and loads it automaticaly into a postgres database daily.

## How to run 
To run this, you will first need Apache Airflow, installation instructions for Apache Airflow can be found [here](https://airflow.apache.org/docs/apache-airflow/stable/installation/installing-from-pypi.html)

- Copy all of this directory contents to your aiflow folder, usualy at `~/airflow`
- Install all the required dependencies by running
  ```bash
    $ pip install -r requirements.txt
  ```
- Then you will need to load all of the required environment variables, a template can be found at [.env.template](./.env.template) file

  The demographic data and geographic data are csv datas in the following format:
### **Demographic data**
  
| Location     | Population | Density (people/kmÂ²) | Urbanization (%) | Average Income (USD) | Education Level (% with Bachelor's or higher) |
| :----------- | :--------- | :------------------- | :--------------- | :------------------- | :-------------------------------------------- |
| Los Angeles  | 10039107   | 3276                 | 89               | 60000                | 32                                            |
| Paris        | 2140526    | 21383                | 98               | 45000                | 29                                            |
| Tokyo        | 13929286   | 6169                 | 100              | 55000                | 37                                            |
| Antananarivo | 1391433    | 3097                 | 69               | 1000                 | 10                                            |
| Nairobi      | 4397073    | 6000                 | 61               | 1500                 | 12                                            |
| Lima         | 9674755    | 3220                 | 81               | 4500                 | 15                                            |


### **Geographic data**

| Location     | Altitude (m) | Proximity to Industry (km) |
| :----------- | :----------- | :------------------------- |
| Los Angeles  | 89           | 5.0                        |
| Paris        | 35           | 3.0                        |
| Tokyo        | 40           | 2.0                        |
| Antananarivo | 1276         | 0.5                        |
| Nairobi      | 1795         | 1.0                        |
| Lima         | 1540         | 1.5                        |


> These examples are already in this repo

- Then you can finally launch or refresh ariflow or start it then enable the DAG under the name Weather API dag


NB: All the tables will be automaticaly generated by this dag if the database are empty